<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nemo.user.products.repository.impl.ProductsImageMapper">
	
	<resultMap id="productImgMap" type="com.nemo.user.products.vo.UserBaseProductsImageVO">
		<id column="product_img_no" property="productImgNo"/>
		<result column="product_no" property="productNo"/>
		<result column="product_img_origin_name" property="productImgOriginName"/>
		<result column="product_img_file_name" property="productImgFileName"/>
		<result column="product_img_file_size" property="productImgFileSize"/>
		<result column="product_img_width" property="productImgWidth"/>
		<result column="product_img_height" property="productImgHeight"/>
		<result column="product_img_type" property="productImgType"/>
		<result column="product_img_dt" property="productImgDt"/>
	</resultMap>

	<insert id="insertImage" 
		parameterType="java.util.List">
	
	<foreach collection="list" item="i" separator=" " open="INSERT ALL" close="SELECT * FROM DUAL">
		
		INTO product_img_tb (
			product_img_no,
			product_no,
			product_img_origin_name,
			product_img_file_name,
			product_img_file_size,
			product_img_width,
			product_img_height,
			product_img_type
		) VALUES (
			get_seq('product_img_sq'),
			#{i.productNo},
			#{i.productImgOriginName},
			#{i.productImgFileName},
			#{i.productImgFileSize},
			#{i.productImgWidth},
			#{i.productImgHeight},
			#{i.productImgType}
		)
		
		</foreach>
		
		<selectKey keyColumn="productImgNo" order="AFTER"> SELECT product_img_sq.currval FROM dual </selectKey>
		
	</insert>

	<!--
		INSERT into product_img_tb (
			product_img_no,
			product_no,
			product_img_origin_name,
			product_img_file_name,
			product_img_file_size,
			product_img_width,
			product_img_height,
			product_img_type
		) SELECT product_img_sq.NEXTVAL, A.* 
		FROM (
    <foreach item="i" collection="list" separator="UNION ALL " >
		#{i.productNo} AS product_no,
		#{i.productImgOriginName} AS product_img_origin_name,
		#{i.productImgFileName} AS product_img_file_name,
		#{i.productImgFileSize} AS product_img_file_size,
		#{i.productImgWidth} AS product_img_width,
		#{i.productImgHeight} AS product_img_height,
		#{i.productImgType} AS product_img_type
        from dual
    </foreach>
    ) A -->

</mapper>